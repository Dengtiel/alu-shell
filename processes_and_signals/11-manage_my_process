#!/usr/bin/env bash
# This script manages the manage_my_process script: start, stop, or restart it.

PID_FILE="/var/run/my_process.pid"
PROCESS_NAME="manage_my_process"

case "$1" in
  start)
    if [ -f "$PID_FILE" ]; then
      echo "$PROCESS_NAME is already running."
    else
      ./manage_my_process &  # Start the process in the background
      echo $! > "$PID_FILE"  # Save the PID to the file
      echo "$PROCESS_NAME started"
    fi
    ;;
  
  stop)
    if [ ! -f "$PID_FILE" ]; then
      echo "$PROCESS_NAME is not running."
    else
      kill "$(cat "$PID_FILE")"  # Stop the process
      rm -f "$PID_FILE"  # Remove the PID file
      echo "$PROCESS_NAME stopped"
    fi
    ;;
  
  restart)
    if [ -f "$PID_FILE" ]; then
      kill "$(cat "$PID_FILE")"  # Stop the existing process
      rm -f "$PID_FILE"  # Remove the PID file
    fi
    ./manage_my_process &  # Start a new process in the background
    echo $! > "$PID_FILE"  # Save the new PID
    echo "$PROCESS_NAME restarted"
    ;;
  
  *)
    echo "Usage: $0 {start|stop|restart}"
    ;;
esac
